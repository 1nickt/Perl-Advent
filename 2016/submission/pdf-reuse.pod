Title: PDF-Resue + Reduce & Recycle
Topic: PDF::Reuse
Author: Raja Renga Bashyam <raja@webstarscg.com>

=pod

In one of our implementation, we had a requirement to produce business cycle documents completely in PDF. It's a billing solution for Advertising Agency System. It has the usual Estimate->Purchase Order->Invoice Cycle with Detail,Rate,Qty & Amount format. Apart from that it has varied column information for handling Print Media & Audio/Video Media with more detail on print media position & A/V media programme slot & timing. In some cases, each media type will be handled by different legal entities for manage tax related issues. Finally, the requirements were:

=for html
    <ol>
        <li>6 work segments(Production, Production with PO, Print Media, Audio/Video, Production iwht TAX)</li>
        <li>Upto 6 different legal entities for each segment</li>
        <li>3 type of estimates</li>
        <li>Purchase Order</li>
        <li>3 type of Release Orders for handle media communication</li>
        <li>3 type of invoices</li>
    </ol>
    
=head2 Challenges

Then we were in search of suitable PDF production module. We mainly looked for: 

=for html
    <ol>        
        <li>Suits to tailor build the document</li>
        <li>Should give production control in pixel level </li>
        <li>Flexible option to set page properties</li>
        <li>Option to implement signatures</li>
        <li>Position control to handle page continuation</li>
    </ol>

After a lengthy search for few days, we finally zeroed in PDF::Reuse. It did not have user friendly function wraps for graphical output, but it offered a developer friendly core functions to control the graphical output in a pixel level. It helped to wrap our custom functions to handle in  generic way.

=head2 Map to Reuse, Reduce & Recycle

    #!perl
    
    use PDF::Reuse;
    use strict;
     
    prFile('myFile.pdf');                  # file to make    
    prForm('source.pdf');                  # page 1 from source.pdf    
    prText(150, 700, 'Customer Data');     # a line of text
    prEnd();

=for html
    <ol>
        <li>The feature of reusing the existing PDF and writing content over that, helped to reuse the existing legal entity letter pads in specific company document production. It's avoided manual graphic production work.</li>
        <li>We classified the document to 3 major parts:
            <ol>
                <li>Page Layout & Page Background</li>
                <li>Header</li>
                <li>Content</li>
            </ol>
        </li>
        <li>A core wrapper function implemented for construct row of row structure to meet individual lines and table like outputs.</li>       
    </ol>

=head2 One Line
    
    Data structure input for produce one liner output
    
    #!perl
    
    # base structure
    
    my $print_data = {0=>{  left_xaxis  =>250,   # print start x position                         
                            line_height =>25,    
                            
                            # column definition
                                                        
                            header      =>{
                                            0=>{font        =>'Helvetica-Bold',
                                                font_size   =>12,
                                            } # column
                            },
                            
                            data=>[['Production Estimate']],
                            
                            },
                    }; 
                    
=begin html

        It will product a title <b>Production Estimate</b> in page center.
        
=end html

=head2 Row of Row

    #!perl
    
    # base structure
    
    my $row_data = {   0=>{
                            line_height =>  12,   
                            
                            # format definition for 3 columns
                            
                            header=>{
                             
                                            0=>{font       => 'Helvetica',
                                                font_size  => 9,
                                                d_width    => 50
                                            },
                                            
                                            1=>{font       => 'Helvetica',
                                                font_size  => 9,
                                                d_width    => 10
                                            },
                                            
                                            2=>{font       => 'Helvetica-Bold',
                                                font_size  => 9,                                            
                                                d_width    => 90,                                                
                                                align      => 'left'
                                            }
                                                
                            }, # end of header
                            
                            # data for 3 columns
                                
                            data=> [                        
                                     ['Client:','','<Client Address>' ],
                                     ['Address:','','<Address 1>' ],
                                     ['','','<Address 2>' ],
                                     ['','','<Address 3>' ],
                                     ['Estimate No.','','<estimate no.>' ],
                                     ['Date:','','<estimate date>' ]
                                     
                                    ],
                                    
                    } # end of def
                    
             }; # end of data
 
=for html
    
    It will produce a row of row output by the given data and format
    
    #!perl
        
    # PDF Creation Wrapper
    
    my $data = $ESTIMATE;
    
    $data->[0]->data[1]='Estimate Detail '; # dynamic data part filled for each key as AoA
        
    &BILL_WsPDF::create($page,
                        $header,
                        $data);



=for html
  <h2>Estimate Production</h2>
  <img src="pdf_estimate.png">
  <br>
  <h2>Print Media Invoice</h2>
  <img src="pdf_print_media.png">


=head2 SEE ALSO

=for :list

* L<PDF::Reuse>

=cut
